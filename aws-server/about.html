<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Health App</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script>
function getURLParameter(name) {
  return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20'))||null
}

$(document).ready(function(){
      	var arr=[];
        $.ajax({
        type:'POST',
        url:'About.php?searchKey='+getURLParameter('searchKey'),
        success:function(res)
        {
        	arr = $.parseJSON( res );
      		console.log(arr[0]);
        
       		$("#name").append(arr[0]['ID']['S']+"<br>");
		
		$("#address").append(arr[0]['Address']['S']+"<br>");
		//google maps

		$("#rating").append(arr[0]['Rating']['N']+"<br>");

		var insert = "<a href=\"AddReview.html?name=" + encodeURIComponent(arr[0]['ID']['S']) + "\"> Add Review </a>";
		
		$("#addReview").append(insert);	
		console.log(arr[0]['Reviews']['SS'].length);
		for( var ctr=0; ctr<(arr[0]['Reviews']['SS'].length); ctr++)
		{		
			var reviewSearchKey = arr[0]['Reviews']['SS'][ctr];
			$.ajax({
        		type:'POST',
        		url:'Review.php?searchKey='+reviewSearchKey,
        		success:function(res)
			{
				reviewArr = $.parseJSON(res);
				console.log(res);
				$("#reviews").append("<br><br>" + reviewArr[0]['From']['S']);
				$("#reviews").append("<br>Quality: "+String(reviewArr[0]['Quality']['N']));
				$("#reviews").append(" Value: "+String(reviewArr[0]['Value']['N']));
				$("#reviews").append(" Cost: "+String(reviewArr[0]['Cost']['N']));
				$("#reviews").append("<br>"+reviewArr[0]['Review']['S']);


			}
                   }).done(function(){
                           
                           var loading = document.getElementById('loading');
                           $(loading).hide();
                           });
						
		}
	}
        });
});
</script>
</head>

<body>
    <div id="home">
        <a href="index.html"/> Home </a>
    </div>
    <hr>
    <div id="loading">
        Loading..
        <hr>
    </div>
<div id="name">
<b>Name: </b>

</div>

<div id="address">
<b>Address: </b>

</div>

<div id="rating">
<b>Overall Rating: </b>
</div>

<div id="reviews">
<b>Reviews: </b>
</div>

<div id="addReview">
</div>


</body>
</html>
